<html>
<head>
	<title>Панель администрирования АПК Quick Queue</title>
	<link rel = 'shortcut icon' href = 'design/favicon.png'>
	<link rel = 'stylesheet' href = 'design/theme.css'>
	<meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
	<script src = './jquery-3.7.1.min.js'></script>
	<script src = 'adminLogin.js'></script>
	<script src = './jquery.maskedinput.min.js'></script>
	<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@100;200;300;400&display=swap" rel="stylesheet">
</head>
<body onload = "if (!getUser()) {  window.location.href = '/'; }">
	<div class = "header">
		<span class = "logo_header" onclick = "location.href='../'">
			<span><img src = 'design/favicon.png' style = "width: 30px"></span>
			<h1>Мониторинг картофельных посадок</h1>
		</span>
	   <span class = "username_header"></span>
	   <span class = "exit_header"><img src = 'design/power.svg' style = "width: 20px" onclick = "exitLK()"></span>
	</div>
	<div class = "body" >
		<div class = "nav"></div>
		<div class = "body_header">
			<h2>Задачи и оценивание</h2>
			<p>В данном разделе Вы можете осуществлять управление задачами и оценками</p>
		</div>
		<div class = "flex_div">
			<button id = "create_task_btn" onclick = "modal_window_controller('createTask_window', 1)">Создать задачу</button>
			<button id = "refresh_task_btn" onclick = "window.location.reload()">Обновить список задач</button>
			<button id = "manage_account_btn" onclick = "modal_window_controller('users_window',1); getUsersTable()">Менеджмент сотрудников</button>
		</div>
		<table id = "tasksListTable">
			<thead>
				<tr>
					<th>ID задачи</th>
					<th>Описание</th>
					<th>Ответственный агроном</th>
					<th>Расположение поля</th>
					<th>Статус задачи</th>
					<th>Действия</th>
				</tr>
			</thead>
			<tbody>
			</tbody>
		</table>
	</div>


	<!--Добавление задачи-->
	<div class = 'modal_wrap_lk'></div>
	<div class = 'modal_window_lk' style = "height: 440px" id = "createTask_window">
		<h3>Создание задачи</h3>
		<form id = 'create_task_form'>
			<div>Описание</div>
			<input name = "description" required placeholder="Выполнить оценку ...">
			<div>Поле</div>
			<select id="fields_dir" name="field_id" required><option selected disabled>Выберите поле</option></select>
			<div>Кому назначается</div>
			<select id="employee_dir" name = "user_id" required><option selected disabled>Выберите сотрудника</option></select>
			<input name = "status" value = "1" class = "hidden_form_field">
		</form>
		<div class = "modal_buttons_panel">
			<button class = "modal_button" data-type = "read" onclick = "$('#create_task_form').submit()">Подтвердить</button>
			<button class = "modal_button" data-type = "cancel" onclick = "modal_window_controller('createTask_window', 0)">Отменить</button>
		</div>
	</div>


	<!--Управление пользователями-->
	<div class = 'modal_window_lk' style = "width: 1100px; height: 450px" id = "users_window">
		<h3 id = "card_name">Управление аккаунтами сотрудников</h3>

		<div class = "table_in_div_head">
			<table>
				<thead>
					<tr>
						<th>ФИО</th>
						<th>Логин</th>
						<th>Роль</th>
						<th colspan = "2">Действия</th>
					</tr>
				</thead>
			</table>
		</div>

		<div class = "table_in_div_body" style = "height: 250px">
			<table>
				<form id = 'new_user_field_form'>
					<tbody id = "users_table">
					</tbody>
				</form>
			</table>
		</div>


		<div class = "modal_buttons_panel">
			<button class = "modal_button" data-type = "read" onclick = "add_staff(this)">Добавить сотрудника</button>
			<button class = "modal_button" data-type = "cancel" onclick = "window.location.reload()">Закрыть менеджер</button>
		</div>
		<input name = "id" class = "hidden_form_field">
	</div>


	<!--Карта задачи-->
	<div class = 'modal_window_lk' style = "width: 1100px; height: 700px" id = "infoTask_window">
		<h3 id = "task_name">Карточка поля</h3>
		<form id = 'edit_field_form'>
			<div>Расположение поля</div>
			<input name = "location" required placeholder="">
			<div>Площадь по документам (в гектарах)</div>
			<input name = "area" required type="number" min="1">
			<input name = "status" value = "1" class = "hidden_form_field">
		</form>


		<div>История посадок</div>
		<div class = "table_in_div_head">
			<table>
				<thead>
					<tr>
						<th>Год</th>
						<th>Сорт</th>
						<th>Дата начала <br> засева </th>
						<th>Дата начала <br> уборки</th>
						<th>Засеяно, <br>га</th>
						<th>Собрано, <br>га</th>
					</tr>
				</thead>
			</table>
		</div>

		<div class = "table_in_div_body">
			<table id = "history_table">
				<form id = 'seazon_field_form'>
					<tbody id = "historyListTable">
					</tbody>
				</form>
			</table>
		</div>

		<div class = "modal_buttons_panel">
			<button class = "modal_button" data-type = "update" onclick = "$('#edit_field_form').submit()">Обновить данные</button>
			<button class = "modal_button" data-type = "cancel" onclick = "delete_field()">Удалить поле</button>
			<button class = "modal_button" data-type = "read" onclick = "add_seazon(this)">Добавить сезон</button>
			<button class = "modal_button" data-type = "confirm" onclick = "window.location.reload()">Закрыть карточку</button>
		</div>
		<input name = "id" class = "hidden_form_field">
	</div>

	<script src = 'app.js'></script>
	<script>
		if (getUser()["role"] > 1) {
			$("#create_task_btn").css("display", "none")
			$("#manage_account_btn").css("display", "none")
		}
	</script>
</body>
</html>